<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
   <meta http-equiv="content-type" content="text/html; charset=windows-1250">
   <meta name="generator" content="PSPad editor, www.pspad.com">
   <link rel="stylesheet" type="text/css" href="../style.css">
   <title>36PAA - ulohy (Michal Trs)</title>
</head>
<body>
   <h1>36PAA - Batoh 2</h1>

   <div id="main">
      <h2>Zadání</h2>
      <ul>
         <li>Naprogramujte øešení 0/1 problému batohu metodou vìtví a hranic (B&B) tak, aby omezujícím faktorem byla hodnota optimalizaèního kritéria. Tj. pouijte oøezávání shora (pøekroèení kapacity batohu) i zdola (stávající øešení nemùe bıt lepší ne nejlepší dosud nalezené)</li>
         <li>Naprogramujte øešení 0/1 problému batohu nebo alespoò 0/1 exaktního problému batohu bez cen metodou dynamického programování.</li>
         <li>Naprogramujte øešení 0/1 problému batohu heuristikou podle pomìru cena/hmotnost s testem nejcennìjší vìci.</li>
      </ul>

      <h2>Definice problému</h2>
      <ul>
         <li>Je dáno:
         <ul>
            <li>celé èíslo n (poèet vìcí)</li>
            <li>celé èíslo M (kapacita batohu)</li>
            <li>koneèná mnoina V={v1, v2, ... ,vn} (hmotnosti vìcí)</li>
            <li>koneèná mnoina C={c1, c2, ... ,cn} (ceny vìcí)</li>
         </ul></li>

         <li>Zkonstruujte mnoinu X={x1, x2, ... ,xn}, kde kadé xi je 0 nebo 1, tak, aby
         <ul>
            <li><b>platilo:</b> v1x1+v2x2 + ... + vnxn <= M (batoh nebyl pøetíen).</li>
            <li><b>vıraz</b> c1x1+c2x2 + ... + cnxn nabıval maximální hodnoty pro všechny takové mnoiny (cena vìcí v batohu byla maximální).</li>
         </ul></li>
      </ul>



      <h2>Implementace</h2>
      Úlohu jsem implementoval v Jazyce C# jako konzolovou aplikaci. Název souboru se vstupními daty je první argument a je povinnı. Druhı argument je nepovinnı a udává poèet opakování vıpoètu jedné instance (Dùleité pouze pøi mìøení èasu).<br/>Maximálnì jsem recykloval úlohu "batoh 1" (virtuální tøída batoh a tøídu program, kde je implementováno mìøení èasu)<ul>
         <li><a href="source/Batoh.cs">Batoh.cs</a> - Virtuální tøída, má implementovanou metody pro ètení vstupního souboru a virtuální metodu Compute().</li>
         <li><a href="source/Program.cs">Program.cs</a> - Volá metodu Compute() a mìøí èas.</li>
         <li><a href="source/GreedyProofMod.cs">GreedyProofMod.cs</a> - Kombinovaná heuristika, rozšíøení jednoduché heuristiky (batoh 1) o test nejcennìjší vìci. Naleznu nejcennìjší vìc a pokud je její cena lepší ne vısledek jednoduché heuristiky (GreedyProof) oznaèím ji za vısledek.</li>
         <li><a href="source/Dyn.cs">Dyn.cs</a> - Dynamické programování dekompozicí podle kapacity batohu. (algoritmus pro vyplnìní 2D pole - slide cv.3)</li>
         <li><a href="source/BB.cs">BB.cs</a> - Metoda vìtví a hranic. Vychází z BruteForce - DFS (batoh 1), které je implementováno rekurzivnì s oøezáváním nepøípustnıch stavù (pøekroèení kapacity batohu). Je pøidáno oøezání neperspektivních stavù po nalezení øešení (pokud expandováním souèasného stavu nemùu dostat lepší øešení, ne které je nalezeno, tento stav dále neexpanduji)</li>
      </ul>


      <h2>Namìøené hodnoty a vısledky</h2>
      <p>Mìøil jsem na NTB s procesorem Centino 1.4GHz, nastavení max Performance pøi napájení z adaptéru. Pouitı OS: Windows XP SP2 s .net Framework 2.</p>

      <h3>Tabulka: Srovnání vıpoèetních èasù</h3>
      <p>Protoe rozlišení èítaèe (Environment.TickCount) je 16 ms, je nutné instance spoèítat vícekrát a vıslednı èas získat vydìlením poètem opakování. Poèet opakování jsem nastavoval experimentálnì, tak aby bylo rozlišení èasu dostateèné).</p>

      <table>
         <tr><th>n</th><th>hrubá síla [ms]</th><th>heuristika [ms]</th><th> kombinovaná heuristika [ms]</th><th>Dynamické programování [ms]</th><th>B&B [ms]</th></tr>
         <tr><td>4</td><td>0,008</td><td>0,007</td><td>0,007</td><td>0,027</td><td>0,007</td></tr>
         <tr><td>10</td><td>0,044</td><td>0,015</td><td>0,014</td><td>0,063</td><td>0,033</td></tr>
         <tr><td>15</td><td>1,230</td><td>0,021</td><td>0,020</td><td>0,168</td><td>0,13</td></tr>
         <tr><td>20</td><td>36,87</td><td>0,027</td><td>0,026</td><td>0,268</td><td>3,43</td></tr>
         <tr><td>22</td><td>136,74</td><td>0,030</td><td>0,030</td><td>0,292</td><td>14,24</td></tr>
         <tr><td>25</td><td>1140,04</td><td>0,034</td><td>0,035</td><td>0,393</td><td>101,33</td></tr>
         <tr><td>27</td><td>4803,90</td><td>0,036</td><td>0,036</td><td>0,490</td><td>400,76</td></tr>
         <tr><td>30</td><td>38723,10</td><td>0,041</td><td>0,039</td><td>0,626</td><td>3371,26</td></tr>
      </table>

      <h3>Tabulka: Prùmìrná chyba heuristik</h3>
      <table>
         <tr><th>n</th><td>4</td><td>10</td><td>15</td><td>20</td><td>22</td><td>25</td><td>27</td><td>30</td></tr>
         <tr><th>jednoduchá heuristika</th><td>2,17%</td><td>1,29%</td><td>0,48%</td><td>0,60%</td><td>0,69%</td><td>0,50%</td><td>0,50%</td><td>0,49%</td></tr>
         <tr><th>kombinovaná heuristika</th><td>1,33%</td><td>1,10%</td><td>0,31%</td><td>0,43%</td><td>0,54%</td><td>0,42%</td><td>0,29%</td><td>0,38%</td></tr>
      </table>

      <h3>Tabulka: Maximální chyba heuristik</h3>
      <table>
         <tr><th>n</th><td>4</td><td>10</td><td>15</td><td>20</td><td>22</td><td>25</td><td>27</td><td>30</td></tr>
         <tr><th>jednoduchá heuristika</th><td>36,36%</td><td>11,48%</td><td>8,54%</td><td>8,43%</td><td>7,23%</td><td>3,68%</td><td>10,60%</td><td>5,51%</td></tr>
         <tr><th>kombinovaná heuristika</th><td>24,75%</td><td>11,48%</td><td>2,77%</td><td>4,08%</td><td>3,02%</td><td>2,59%</td><td>1,85%</td><td>1,75%</td></tr>
      </table>


      <h3>Graf: Èasová závislost</h3>
      <p><img src="grafy/slozitost.png" alt="èasová sloitost"/></p>

      <h3>Graf: Závislost prùmìrné chyby na velikosti instance</h3>
      <p><img src="grafy/pr_chyba.png" alt="Závislost prùmìrné chyby na velikosti instance"/></p>

      <h3>Graf: Závislost maximální chyby na velikosti instance</h3>
      <p><img src="grafy/max_chyba.png" alt="Závislost maximální chyby na velikosti instance"/></p>


      <h2>Závìr</h2>
      <p>
         Oproti "jednoduchım" metodám øešení, pouitıch v úloze batoh 1, je z grafù dobøe patrné velké sníení èasové nároènosti. Metoda vìtví a hranic (B&B) pøináší zlepšení o jeden øád oproti DFS. Pøitom se jedná o pøidání jedné podmínky.<br/>Ještì mnohem lepších vısledkù dosahuje metoda dynamického programovaní. Sice v porovnání s heuristikou (greedyProof) je o øád pomalejší, ale oproti ní poskytuje vdy optimální øešení. Pouze si musíme uvìdomit pamìovou sloitost, která je dána 2D polem, v tomto pøípadì M.n. Pøidáním testu nejcennìjší vìci do heuristiky se sníila prùmìrná a maximální chyba.
      </p>

   </div>


</body>
</html>
