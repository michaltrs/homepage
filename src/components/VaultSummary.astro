---
import { getCollection } from 'astro:content';

const allEntries = await getCollection('vault');

const timelinePoints = [
  { id: 'spse-v-uzlabine', label: 'SPŠE V Úžlabině', period: '1999–2002', color: 'bg-orange-500', textColor: 'text-orange-500' },
  { id: 'cnk', label: 'Cesty na kole', period: '2001–2009', color: 'bg-joy-yellow', textColor: 'text-joy-yellow' },
  { id: 'cvut-fel', label: 'ČVUT FEL', period: '2002–2008', color: 'bg-sky-blue', textColor: 'text-sky-blue' },
  { id: 'blog', label: 'Blog', period: '2008–2013', color: 'bg-slate-400', textColor: 'text-slate-500' },
].map(point => ({
  ...point,
  count: allEntries.filter(e => e.data.category === point.id).length,
}));
---

<section id="history-summary" class="py-24 px-6 bg-soft-bg/50 border-t border-charcoal/5">
  <div class="max-w-6xl mx-auto">
    <div class="text-center mb-16">
      <h2 class="text-charcoal/40 font-bold tracking-widest uppercase text-sm mb-4">
        Timeline & Legacy
      </h2>
      <h3 class="text-4xl md:text-5xl font-extrabold text-charcoal mb-6 font-outfit">
        Střípky z historie
      </h3>
      <p class="text-lg text-charcoal/60 max-w-2xl mx-auto font-medium">
        Cesta od prvních kódů a cyklo-expedic k vedení globálních engineering týmů.
        Protože každá přítomnost má své základy v minulosti.
      </p>
    </div>

    <!-- Horizontal Mini Timeline -->
    <div class="relative max-w-4xl mx-auto mb-16">
      <!-- Timeline line -->
      <div class="absolute top-6 left-0 right-0 h-0.5 bg-charcoal/10 hidden md:block"></div>

      <div class="grid grid-cols-2 md:grid-cols-4 gap-6 md:gap-4">
        {timelinePoints.map((point) => (
          <a href={`/vault?category=${point.id}`} class="group relative flex flex-col items-center text-center">
            <!-- Node -->
            <div class={`w-12 h-12 rounded-full ${point.color} flex items-center justify-center text-white font-bold text-sm mb-4 shadow-md group-hover:scale-110 transition-transform z-10`}>
              {point.count}
            </div>
            <!-- Period -->
            <span class="text-xs font-bold text-charcoal/40 mb-1">{point.period}</span>
            <!-- Label -->
            <span class={`text-sm font-bold ${point.textColor} group-hover:underline`}>{point.label}</span>
          </a>
        ))}
      </div>
    </div>

    <div class="text-center z-20 relative">
      <a href="/vault" class="inline-flex items-center gap-3 px-8 py-4 bg-charcoal text-white rounded-full font-bold hover:bg-sky-blue transition-all group shadow-xl hover:shadow-sky-blue/20">
        Prozkoumat celý archiv (The Vault)
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="group-hover:translate-x-1 transition-transform"><path d="M5 12h14"/><path d="m12 5 7 7-7 7"/></svg>
      </a>
    </div>
  </div>
</section>

<style>
  .font-outfit { font-family: 'Outfit', sans-serif; }
</style>
